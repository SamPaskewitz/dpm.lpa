<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>fitting_LPA_model</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">fitting_LPA_model</h1>



<div id="introduction." class="section level2">
<h2>Introduction.</h2>
<p>This vignette illustrates Dirichlet Process Mixture Latent Profile
Analysis (DPM-LPA). It uses a fake data set (lpa_example_data) that
includes data from several cognitive tasks (nback_digit, nback_picture,
stroop, trail_making, wcst) and school grades in different subjects
(math, reading, gym). The goal of the analysis is to form latent
profiles based on the cognitive tasks then see whether these profiles
are related to school grades.</p>
</div>
<div id="set-up." class="section level2">
<h2>Set up.</h2>
<div id="load-the-dpm.lpa-r-package." class="section level3">
<h3>Load the dpm.lpa R package.</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(dpm.lpa)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="co">#&gt; Loading required package: reticulate</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;reticulate&#39; was built under R version 4.3.3</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># To build: devtools::build_vignettes()</span></span></code></pre></div>
</div>
<div id="update-relevant-python-packages-to-the-latest-versions-this-is-optional-and-thus-commented-out." class="section level3">
<h3>Update relevant Python packages to the latest versions (this is
optional and thus commented out).</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">#update_python_packages()</span></span></code></pre></div>
</div>
<div id="load-data." class="section level3">
<h3>Load data.</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">data</span>(lpa_example_data)</span></code></pre></div>
</div>
<div id="fit-the-dpm-lpa-model" class="section level3">
<h3>fit the DPM-LPA model</h3>
<p>This function fits the DPM-LPA model to your data.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>fitted_lpa <span class="ot">=</span> <span class="fu">fit_dpm_lpa</span>(<span class="at">x =</span> lpa_example_data[, <span class="fu">c</span>(<span class="st">&#39;wcst&#39;</span>, <span class="st">&#39;stroop&#39;</span>, <span class="st">&#39;trail_making&#39;</span>, <span class="st">&#39;nback_digit&#39;</span>, <span class="st">&#39;nback_picture&#39;</span>)])</span></code></pre></div>
</div>
</div>
<div id="assess-model-assumptions" class="section level2">
<h2>assess model assumptions</h2>
<div id="plot-histograms-of-residuals-normality-assumption" class="section level3">
<h3>plot histograms of residuals (normality assumption)</h3>
<p>This is a simple diagnostic plot to assess the model’s assumption
that each variable is normally distributed within each profile, which is
similar to the normality assumption in ANOVA or linear regression.
Histograms of residuals (observations - predicted values, shown as dark
gray bars) are plotted alongside normal distributions with the same
standard deviation (in blue). If the residuals of one variable are too
far from being normally distributed, e.g. if they are highly skewed,
then you should consider transforming that variable (much like in linear
regression) and then re-doing the LPA model fit. We can see that the
residuals for trail_making are very right-skewed, so we should try a
log-transformation.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">plot_lpa_residuals</span>(fitted_lpa)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; &lt;Figure Size: (400 x 300)&gt;</span></span></code></pre></div>
</div>
<div id="look-at-residual-correlation-matrix-local-independence-assumption" class="section level3">
<h3>look at residual correlation matrix (local independence
assumption)</h3>
<p>Standard LPA assumes that the observed variables (x) are independent
conditioned on latent profile. Thus, the residuals should be
uncorrelated. This function plots the residual correlation matrix. The
off-diagonal elements should be close to 0. However, we can see that the
correlation between nback_digit and nback_picture is extremely high,
suggesting that these variables are redundant. One of them should be
dropped.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">lpa_residual_correlations</span>(fitted_lpa)</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a><span class="co">#&gt;    wcst stroop trail_making nback_digit nback_picture</span></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co">#&gt; 1  1.00  -0.15         0.17       -0.13         -0.09</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a><span class="co">#&gt; 2 -0.15   1.00         0.05       -0.16         -0.19</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a><span class="co">#&gt; 3  0.17   0.05         1.00       -0.02          0.01</span></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; 4 -0.13  -0.16        -0.02        1.00          0.92</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt; 5 -0.09  -0.19         0.01        0.92          1.00</span></span></code></pre></div>
</div>
</div>
<div id="fit-the-model-again-with-revised-data" class="section level2">
<h2>fit the model again with revised data</h2>
<div id="revise-the-data-set" class="section level3">
<h3>revise the data set</h3>
<p>We will log-transform trail_making to fix its skewed residuals, and
drop nback_picture because its residuals are so highly correlated with
those of nback_digit.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>x_v2 <span class="ot">=</span> lpa_example_data[, <span class="fu">c</span>(<span class="st">&#39;wcst&#39;</span>, <span class="st">&#39;stroop&#39;</span>, <span class="st">&#39;trail_making&#39;</span>, <span class="st">&#39;nback_digit&#39;</span>)] <span class="co"># drop nback_picture</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>x_v2<span class="sc">$</span>trail_making <span class="ot">=</span> <span class="fu">log</span>(x_v2<span class="sc">$</span>trail_making) <span class="co"># log-transform trail_making</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>x_v2 <span class="ot">=</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(x_v2)) <span class="co"># scale, i.e. z-score</span></span></code></pre></div>
</div>
<div id="re-fit-the-model" class="section level3">
<h3>re-fit the model</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>fitted_lpa_v2 <span class="ot">=</span> <span class="fu">fit_dpm_lpa</span>(<span class="at">x =</span> x_v2)</span></code></pre></div>
</div>
<div id="check-residual-normality-again" class="section level3">
<h3>check residual normality again</h3>
<p>All of the residuals look nice and normally distributed. It looks
like the log-transformation of trail_making worked.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">plot_lpa_residuals</span>(fitted_lpa_v2)</span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a><span class="co">#&gt; &lt;Figure Size: (400 x 300)&gt;</span></span></code></pre></div>
</div>
<div id="check-residual-correlations-again" class="section level3">
<h3>check residual correlations again</h3>
<p>The residuals are nice and uncorrelated. It looks like the revised
model (fitted_lpa_v2) is good to go.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">lpa_residual_correlations</span>(fitted_lpa_v2)</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="co">#&gt;    wcst stroop trail_making nback_digit</span></span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a><span class="co">#&gt; 1  1.00  -0.28         0.01       -0.21</span></span>
<span id="cb11-4"><a href="#cb11-4" tabindex="-1"></a><span class="co">#&gt; 2 -0.28   1.00         0.12       -0.02</span></span>
<span id="cb11-5"><a href="#cb11-5" tabindex="-1"></a><span class="co">#&gt; 3  0.01   0.12         1.00       -0.06</span></span>
<span id="cb11-6"><a href="#cb11-6" tabindex="-1"></a><span class="co">#&gt; 4 -0.21  -0.02        -0.06        1.00</span></span></code></pre></div>
</div>
</div>
<div id="look-at-the-fitted-model" class="section level2">
<h2>look at the fitted model</h2>
<div id="print-summary-of-profile-fit" class="section level3">
<h3>print summary of profile fit</h3>
<p>This function gives a basic summary of the fitted LPA model,
including the number of observations (participants), the proportional
reduction in entropy (a measure of how “certain” the model is in
assigning participants to profiles), the number of profiles, the number
of people in each profile, estimates of profile means (mu) etc.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">print_lpa_summary</span>(fitted_lpa_v2)</span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a><span class="co">#&gt; n = 200</span></span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a><span class="co">#&gt; proportional entropy reduction: 0.89</span></span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="co">#&gt; (= 1 - entropy of z/max entropy of z)</span></span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a><span class="co">#&gt; number of non-empty profiles: 3</span></span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a><span class="co">#&gt; pi (profile probabilties): </span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a><span class="co">#&gt;   profile 1  profile 2  profile 3</span></span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a><span class="co">#&gt;        0.55       0.34       0.11</span></span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a><span class="co">#&gt; number in each profile: </span></span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a><span class="co">#&gt;   profile 1  profile 2  profile 3</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a><span class="co">#&gt;         110         68         22</span></span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a><span class="co">#&gt; mu: (means)</span></span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a><span class="co">#&gt;               profile 1  profile 2  profile 3</span></span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a><span class="co">#&gt; wcst               0.49      -1.00       0.49</span></span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a><span class="co">#&gt; stroop             0.59      -0.99       0.08</span></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a><span class="co">#&gt; trail_making      -0.10      -0.13       0.67</span></span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a><span class="co">#&gt; nback_digit       -0.12      -0.39       1.36</span></span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a><span class="co">#&gt; xi: (precisions, i.e. inverse variances)</span></span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a><span class="co">#&gt;   wcst  stroop  trail_making  nback_digit</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a><span class="co">#&gt;   1.86    1.93          1.06         1.43</span></span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a><span class="co">#&gt; proportion of the sample contained in the K biggest profiles</span></span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a><span class="co">#&gt;   K = 1  K = 2  K = 3</span></span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a><span class="co">#&gt;    0.55   0.89    1.0</span></span></code></pre></div>
</div>
<div id="plot-estimated-profile-means-mu" class="section level3">
<h3>plot estimated profile means (mu)</h3>
<p>This plots the estimated means of each profile on each latent
variable. By default, the plot is broken into facets (subplots) based on
latent profile, with variable on the x-axis, and the posterior
distribution expected values of each profile mean are plotted as bars.
However other varieties of plot are available: see the function’s
documentation for details.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="fu">plot_profile_means</span>(fitted_lpa_v2)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="co">#&gt; &lt;Figure Size: (400 x 300)&gt;</span></span></code></pre></div>
</div>
<div id="plot-estimated-profile-base-rates-probabilities-pi" class="section level3">
<h3>plot estimated profile base rates (probabilities, pi)</h3>
<p>This simply plots the estimated base rates (probabilities) of the
latent profiles using bars.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">plot_profile_probs</span>(fitted_lpa_v2)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; &lt;Figure Size: (400 x 300)&gt;</span></span></code></pre></div>
</div>
</div>
<div id="extract-estimated-latent-profiles" class="section level2">
<h2>extract estimated latent profiles</h2>
<div id="extract-hard-estimates-of-latent-profiles" class="section level3">
<h3>extract “hard” estimates of latent profiles</h3>
<p>This function extracts a data frame of “hard” estimates of each
participant’s latent profile, i.e. the most probable latent profile for
each participant. This data can then be used for other analyses,
exported (using write.csv for example) etc.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>profiles <span class="ot">=</span> <span class="fu">extract_profiles</span>(fitted_lpa_v2)</span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a><span class="fu">head</span>(profiles)</span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a><span class="co">#&gt;      profile</span></span>
<span id="cb15-4"><a href="#cb15-4" tabindex="-1"></a><span class="co">#&gt; ID_1       1</span></span>
<span id="cb15-5"><a href="#cb15-5" tabindex="-1"></a><span class="co">#&gt; ID_2       1</span></span>
<span id="cb15-6"><a href="#cb15-6" tabindex="-1"></a><span class="co">#&gt; ID_3       1</span></span>
<span id="cb15-7"><a href="#cb15-7" tabindex="-1"></a><span class="co">#&gt; ID_4       3</span></span>
<span id="cb15-8"><a href="#cb15-8" tabindex="-1"></a><span class="co">#&gt; ID_5       1</span></span>
<span id="cb15-9"><a href="#cb15-9" tabindex="-1"></a><span class="co">#&gt; ID_6       1</span></span></code></pre></div>
</div>
<div id="extract-soft-estimates-of-latent-profiles" class="section level3">
<h3>extract “soft” estimates of latent profiles</h3>
<p>By specifying ‘profile_probs = TRUE’, the function will instead
extract a data frame of “soft” latent profiles estimates, i.e. the
probability that each person is in each latent profile.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a>soft_profiles <span class="ot">=</span> <span class="fu">extract_profiles</span>(fitted_lpa_v2, <span class="at">profile_probs =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a><span class="fu">head</span>(soft_profiles)</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a><span class="co">#&gt;      P(profile 1) P(profile 2) P(profile 3)</span></span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a><span class="co">#&gt; ID_1    0.9861563 8.579349e-03  0.005243390</span></span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a><span class="co">#&gt; ID_2    0.9982505 1.501239e-05  0.001732197</span></span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a><span class="co">#&gt; ID_3    0.9574621 2.036478e-02  0.022139496</span></span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a><span class="co">#&gt; ID_4    0.4191686 3.260224e-04  0.580496427</span></span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a><span class="co">#&gt; ID_5    0.9865711 1.079460e-02  0.002613786</span></span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a><span class="co">#&gt; ID_6    0.9752380 1.364390e-03  0.023383462</span></span></code></pre></div>
</div>
</div>
<div id="outcome-analysis" class="section level2">
<h2>outcome analysis</h2>
<p>We now want to see if the latent profiles are related to some outcome
variables. We first use the ‘outcome_analysis_normal’ function to run
the analysis. This returns a list with various results. We save this
list as ‘result’. You can view the function’s documentation (using
‘?outcome_analysis_normal’) for a description of each of the elements
contained in the function’s output. We are mainly interested in two
outputs: the results of analysis using Bayes factors, and a plot of
estimated profile outcome means.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>result <span class="ot">=</span> <span class="fu">outcome_analysis_normal</span>(<span class="at">model =</span> fitted_lpa_v2,</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>                                 <span class="at">y =</span> lpa_example_data[, <span class="fu">c</span>(<span class="st">&#39;math&#39;</span>, <span class="st">&#39;reading&#39;</span>, <span class="st">&#39;gym&#39;</span>)])</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a><span class="co">#&gt;                 bf10 log10_bf10           conclusion post_hoc_result</span></span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a><span class="co">#&gt; math    7.762398e+14      14.89 profile means differ   {1}, {2}, {3}</span></span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a><span class="co">#&gt; reading 5.170000e+00       0.71 profile means differ     {1, 2}, {3}</span></span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a><span class="co">#&gt; gym     9.000000e-02      -1.05      profile means =            &lt;NA&gt;</span></span></code></pre></div>
<div id="bayes-factors" class="section level3">
<h3>Bayes Factors</h3>
<p>This table reports the results of Bayesian analysis of variance (*
INSERT REF *). The first column (“bf10”) reports the Bayes factor, which
is the ratio of evidence for H1 (the latent profiles have different
means) divided by the evidence for H0 (the latent profiles have the same
mean). The second column (“log10_bf10”) reports the base-10 logarithm of
the Bayes factor, which can be easier to interpret. The third column
(“conclusion”) reports the conclusion of the Bayes factor, which is that
the profile means differ, are equal, or the evidence is not decisive.
This is based on the conventional criterion of log10(BF) &gt; 0.5 being
decisive. Finally, the fourth column (“post_hoc_result”) reports the
result of post-hoc analysis, which partitions the latent profiles into
groups that have the same mean as each other. See the function
documentation for further details.</p>
<p>In this example, the Bayes factors indicate that the profiles have
different means for math and reading (with stronger evidence in the case
of math), but have the same mean for gym (the null hypothesis is
supported, something we can do in Bayesian analysis). Post-hoc tests
indicate that all three profile have different means for math, but that
profiles 1 and 2 have the same mean for reading (with profile 3 having a
different mean).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a>result<span class="sc">$</span>bayes_factors</span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a><span class="co">#&gt;                 bf10 log10_bf10           conclusion post_hoc_result</span></span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a><span class="co">#&gt; math    7.762398e+14      14.89 profile means differ   {1}, {2}, {3}</span></span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a><span class="co">#&gt; reading 5.170000e+00       0.71 profile means differ     {1, 2}, {3}</span></span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a><span class="co">#&gt; gym     9.000000e-02      -1.05      profile means =            &lt;NA&gt;</span></span></code></pre></div>
</div>
<div id="plot-of-profile-outcome-variable-means-95-credible-interval" class="section level3">
<h3>Plot of profile outcome variable means (95% credible interval)</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>result<span class="sc">$</span>plot<span class="sc">$</span><span class="fu">show</span>()</span></code></pre></div>
</div>
<div id="data-frame-of-profile-outcome-means-same-data-that-is-plotted-above" class="section level3">
<h3>data frame of profile outcome means (same data that is plotted
above)</h3>
<p>This is a data frame containing the same data that is plotted above.
It gives the posterior mean (mu), variance (v), and the lower and upper
bounds of the 95% credible interval (mu_minus, mu_plus) of each
profile’s mean for each outcome variable. This data frame can be
exported if desired (using the write.csv function for example).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>result<span class="sc">$</span>plot_df</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a><span class="co">#&gt;   j profile variable          mu           v   mu_minus     mu_plus</span></span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a><span class="co">#&gt; 1 0       1     math  0.27457635 0.006144443  0.1209388  0.42821388</span></span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a><span class="co">#&gt; 2 0       2     math -0.74009836 0.009884538 -0.9349636 -0.54523318</span></span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a><span class="co">#&gt; 3 0       3     math  0.89516574 0.029653614  0.5576493  1.23268215</span></span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a><span class="co">#&gt; 4 1       1  reading -0.04440895 0.008596141 -0.2261311  0.13731318</span></span>
<span id="cb20-7"><a href="#cb20-7" tabindex="-1"></a><span class="co">#&gt; 5 1       2  reading -0.13372173 0.013828574 -0.3642078  0.09676439</span></span>
<span id="cb20-8"><a href="#cb20-8" tabindex="-1"></a><span class="co">#&gt; 6 1       3  reading  0.61548664 0.041485722  0.2162730  1.01470030</span></span>
<span id="cb20-9"><a href="#cb20-9" tabindex="-1"></a><span class="co">#&gt; 7 2       1      gym  0.05329715 0.009022706 -0.1328792  0.23947349</span></span>
<span id="cb20-10"><a href="#cb20-10" tabindex="-1"></a><span class="co">#&gt; 8 2       2      gym -0.06347031 0.014514788 -0.2996059  0.17266527</span></span>
<span id="cb20-11"><a href="#cb20-11" tabindex="-1"></a><span class="co">#&gt; 9 2       3      gym -0.06680576 0.043544365 -0.4758046  0.34219306</span></span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
